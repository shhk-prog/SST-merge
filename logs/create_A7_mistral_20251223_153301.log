/mnt/iag-02/home/hiromi/src/SST_merge/sst/lib/python3.12/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-23 15:33:04,363 - __main__ - INFO - 
================================================================================
2025-12-23 15:33:04,363 - __main__ - INFO - A7 (Security) MODEL CREATION
2025-12-23 15:33:04,363 - __main__ - INFO - ================================================================================
2025-12-23 15:33:04,363 - __main__ - INFO - 
Loading training dataset...
2025-12-23 15:33:04,520 - src.utils.instruction_loaders - INFO - Loading Security dataset from data/response_dataframe.csv...
2025-12-23 15:33:04,529 - src.utils.instruction_loaders - INFO - Loaded 1400 samples from Security dataset
2025-12-23 15:33:04,529 - src.utils.instruction_loaders - INFO - Created Security DataLoader: 1400 samples, batch_size=32
2025-12-23 15:33:04,530 - __main__ - INFO - ✓ Dataset loaded
2025-12-23 15:33:04,530 - __main__ - INFO - 
Loading model: mistral-7b-v0.2...
2025-12-23 15:33:04,530 - src.utils.model_loader - INFO - ModelLoader initialized: model=mistralai/Mistral-7B-Instruct-v0.2, device_map=auto, dtype=torch.bfloat16
2025-12-23 15:33:04,530 - src.utils.model_loader - INFO - Loading model: mistralai/Mistral-7B-Instruct-v0.2
2025-12-23 15:33:05,359 - src.utils.model_loader - INFO - Using Flash Attention 2 for faster inference
`torch_dtype` is deprecated! Use `dtype` instead!
2025-12-23 15:33:06,206 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.14it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.08it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.09it/s]
2025-12-23 15:33:10,242 - src.utils.model_loader - INFO - ✓ Model loaded successfully: mistralai/Mistral-7B-Instruct-v0.2
2025-12-23 15:33:10,243 - src.utils.model_loader - INFO -   Total parameters: 7.24B
2025-12-23 15:33:10,243 - src.utils.model_loader - INFO -   Device map: {'': 0}
2025-12-23 15:33:10,243 - __main__ - INFO - ✓ Model loaded
2025-12-23 15:33:10,243 - __main__ - INFO - 
Fine-tuning on Security data...
2025-12-23 15:33:10,243 - src.lora_trainer - INFO - LoRATrainer initialized on device: cuda
2025-12-23 15:33:10,243 - src.lora_trainer - INFO - 
Training LoRA adapter for benign task...
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   Epochs: 3
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   Learning rate: 0.0002
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   LoRA rank: 16
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   LoRA alpha: 32
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   LoRA dropout: 0.05
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   Weight decay: 0.01
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   Warmup ratio: 0.1
2025-12-23 15:33:10,243 - src.lora_trainer - INFO -   Gradient accumulation steps: 8
2025-12-23 15:33:11,864 - src.lora_trainer - INFO -   Gradient checkpointing enabled
2025-12-23 15:33:11,874 - src.lora_trainer - INFO -   Total training steps: 132
2025-12-23 15:33:11,874 - src.lora_trainer - INFO -   Warmup steps: 13
/mnt/iag-02/home/hiromi/src/SST_merge/src/lora_trainer.py:210: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
2025-12-23 15:33:11,874 - src.lora_trainer - INFO -   Mixed precision training enabled
Epoch 1/3:   0%|          | 0/44 [00:00<?, ?it/s]/mnt/iag-02/home/hiromi/src/SST_merge/src/lora_trainer.py:266: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
Casting fp32 inputs back to torch.float16 for flash-attn compatibility.
Epoch 1/3:   0%|          | 0/44 [00:02<?, ?it/s, loss=0.6950]Epoch 1/3:   2%|▏         | 1/44 [00:02<01:58,  2.76s/it, loss=0.6950]Epoch 1/3:   2%|▏         | 1/44 [00:04<01:58,  2.76s/it, loss=0.6846]Epoch 1/3:   5%|▍         | 2/44 [00:04<01:36,  2.30s/it, loss=0.6846]Epoch 1/3:   5%|▍         | 2/44 [00:07<01:36,  2.30s/it, loss=0.6081]Epoch 1/3:   7%|▋         | 3/44 [00:07<01:38,  2.39s/it, loss=0.6081]Epoch 1/3:   7%|▋         | 3/44 [00:09<01:38,  2.39s/it, loss=0.7011]Epoch 1/3:   9%|▉         | 4/44 [00:09<01:30,  2.25s/it, loss=0.7011]Epoch 1/3:   9%|▉         | 4/44 [00:11<01:30,  2.25s/it, loss=0.6768]Epoch 1/3:  11%|█▏        | 5/44 [00:11<01:29,  2.30s/it, loss=0.6768]Epoch 1/3:  11%|█▏        | 5/44 [00:14<01:29,  2.30s/it, loss=0.6470]Epoch 1/3:  14%|█▎        | 6/44 [00:14<01:29,  2.35s/it, loss=0.6470]Epoch 1/3:  14%|█▎        | 6/44 [00:16<01:29,  2.35s/it, loss=0.6592]Epoch 1/3:  16%|█▌        | 7/44 [00:16<01:27,  2.36s/it, loss=0.6592]Epoch 1/3:  16%|█▌        | 7/44 [00:18<01:27,  2.36s/it, loss=0.6741]Epoch 1/3:  18%|█▊        | 8/44 [00:18<01:24,  2.36s/it, loss=0.6741]Epoch 1/3:  18%|█▊        | 8/44 [00:21<01:24,  2.36s/it, loss=0.6509]Epoch 1/3:  20%|██        | 9/44 [00:21<01:22,  2.36s/it, loss=0.6509]Epoch 1/3:  20%|██        | 9/44 [00:23<01:22,  2.36s/it, loss=0.6608]Epoch 1/3:  23%|██▎       | 10/44 [00:23<01:20,  2.38s/it, loss=0.6608]Epoch 1/3:  23%|██▎       | 10/44 [00:25<01:20,  2.38s/it, loss=0.6787]Epoch 1/3:  25%|██▌       | 11/44 [00:25<01:17,  2.35s/it, loss=0.6787]Epoch 1/3:  25%|██▌       | 11/44 [00:28<01:17,  2.35s/it, loss=0.6678]Epoch 1/3:  27%|██▋       | 12/44 [00:28<01:15,  2.36s/it, loss=0.6678]Epoch 1/3:  27%|██▋       | 12/44 [00:30<01:15,  2.36s/it, loss=0.6618]Epoch 1/3:  30%|██▉       | 13/44 [00:30<01:13,  2.37s/it, loss=0.6618]Epoch 1/3:  30%|██▉       | 13/44 [00:32<01:13,  2.37s/it, loss=0.6476]Epoch 1/3:  32%|███▏      | 14/44 [00:32<01:10,  2.35s/it, loss=0.6476]Epoch 1/3:  32%|███▏      | 14/44 [00:35<01:10,  2.35s/it, loss=0.6811]Epoch 1/3:  34%|███▍      | 15/44 [00:35<01:08,  2.35s/it, loss=0.6811]Epoch 1/3:  34%|███▍      | 15/44 [00:37<01:08,  2.35s/it, loss=0.6668]Epoch 1/3:  36%|███▋      | 16/44 [00:37<01:06,  2.38s/it, loss=0.6668]Epoch 1/3:  36%|███▋      | 16/44 [00:40<01:06,  2.38s/it, loss=0.6737]Epoch 1/3:  39%|███▊      | 17/44 [00:40<01:03,  2.36s/it, loss=0.6737]Epoch 1/3:  39%|███▊      | 17/44 [00:42<01:03,  2.36s/it, loss=0.6350]Epoch 1/3:  41%|████      | 18/44 [00:42<01:01,  2.38s/it, loss=0.6350]Epoch 1/3:  41%|████      | 18/44 [00:44<01:01,  2.38s/it, loss=0.6544]Epoch 1/3:  43%|████▎     | 19/44 [00:44<00:59,  2.38s/it, loss=0.6544]Epoch 1/3:  43%|████▎     | 19/44 [00:47<00:59,  2.38s/it, loss=0.6500]Epoch 1/3:  45%|████▌     | 20/44 [00:47<00:56,  2.36s/it, loss=0.6500]Epoch 1/3:  45%|████▌     | 20/44 [00:49<00:56,  2.36s/it, loss=0.6584]Epoch 1/3:  48%|████▊     | 21/44 [00:49<00:54,  2.37s/it, loss=0.6584]Epoch 1/3:  48%|████▊     | 21/44 [00:52<00:54,  2.37s/it, loss=0.6700]Epoch 1/3:  50%|█████     | 22/44 [00:52<00:52,  2.39s/it, loss=0.6700]Epoch 1/3:  50%|█████     | 22/44 [00:54<00:52,  2.39s/it, loss=0.6376]Epoch 1/3:  52%|█████▏    | 23/44 [00:54<00:50,  2.42s/it, loss=0.6376]Epoch 1/3:  52%|█████▏    | 23/44 [00:56<00:50,  2.42s/it, loss=0.6839]Epoch 1/3:  55%|█████▍    | 24/44 [00:56<00:48,  2.41s/it, loss=0.6839]Epoch 1/3:  55%|█████▍    | 24/44 [00:59<00:48,  2.41s/it, loss=0.6509]Epoch 1/3:  57%|█████▋    | 25/44 [00:59<00:45,  2.38s/it, loss=0.6509]Epoch 1/3:  57%|█████▋    | 25/44 [01:01<00:45,  2.38s/it, loss=0.6664]Epoch 1/3:  59%|█████▉    | 26/44 [01:01<00:42,  2.37s/it, loss=0.6664]Epoch 1/3:  59%|█████▉    | 26/44 [01:03<00:42,  2.37s/it, loss=0.6709]Epoch 1/3:  61%|██████▏   | 27/44 [01:03<00:39,  2.35s/it, loss=0.6709]Epoch 1/3:  61%|██████▏   | 27/44 [01:06<00:39,  2.35s/it, loss=0.6750]Epoch 1/3:  64%|██████▎   | 28/44 [01:06<00:37,  2.35s/it, loss=0.6750]Epoch 1/3:  64%|██████▎   | 28/44 [01:08<00:37,  2.35s/it, loss=0.6799]Epoch 1/3:  66%|██████▌   | 29/44 [01:08<00:35,  2.35s/it, loss=0.6799]Epoch 1/3:  66%|██████▌   | 29/44 [01:11<00:35,  2.35s/it, loss=0.6684]Epoch 1/3:  68%|██████▊   | 30/44 [01:11<00:33,  2.38s/it, loss=0.6684]Epoch 1/3:  68%|██████▊   | 30/44 [01:13<00:33,  2.38s/it, loss=0.6608]Epoch 1/3:  70%|███████   | 31/44 [01:13<00:30,  2.36s/it, loss=0.6608]Epoch 1/3:  70%|███████   | 31/44 [01:15<00:30,  2.36s/it, loss=0.6669]Epoch 1/3:  73%|███████▎  | 32/44 [01:15<00:26,  2.25s/it, loss=0.6669]Epoch 1/3:  73%|███████▎  | 32/44 [01:17<00:26,  2.25s/it, loss=0.6916]Epoch 1/3:  75%|███████▌  | 33/44 [01:17<00:24,  2.26s/it, loss=0.6916]Epoch 1/3:  75%|███████▌  | 33/44 [01:20<00:24,  2.26s/it, loss=0.6437]Epoch 1/3:  77%|███████▋  | 34/44 [01:20<00:23,  2.33s/it, loss=0.6437]Epoch 1/3:  77%|███████▋  | 34/44 [01:22<00:23,  2.33s/it, loss=0.6681]Epoch 1/3:  80%|███████▉  | 35/44 [01:22<00:20,  2.32s/it, loss=0.6681]Epoch 1/3:  80%|███████▉  | 35/44 [01:24<00:20,  2.32s/it, loss=0.6764]Epoch 1/3:  82%|████████▏ | 36/44 [01:24<00:18,  2.36s/it, loss=0.6764]Epoch 1/3:  82%|████████▏ | 36/44 [01:27<00:18,  2.36s/it, loss=0.6324]Epoch 1/3:  84%|████████▍ | 37/44 [01:27<00:16,  2.34s/it, loss=0.6324]Epoch 1/3:  84%|████████▍ | 37/44 [01:29<00:16,  2.34s/it, loss=0.6361]Epoch 1/3:  86%|████████▋ | 38/44 [01:29<00:14,  2.38s/it, loss=0.6361]Epoch 1/3:  86%|████████▋ | 38/44 [01:31<00:14,  2.38s/it, loss=0.6523]Epoch 1/3:  89%|████████▊ | 39/44 [01:31<00:11,  2.38s/it, loss=0.6523]Epoch 1/3:  89%|████████▊ | 39/44 [01:34<00:11,  2.38s/it, loss=0.6540]Epoch 1/3:  91%|█████████ | 40/44 [01:34<00:09,  2.36s/it, loss=0.6540]Epoch 1/3:  91%|█████████ | 40/44 [01:36<00:09,  2.36s/it, loss=0.6651]Epoch 1/3:  93%|█████████▎| 41/44 [01:36<00:07,  2.39s/it, loss=0.6651]Epoch 1/3:  93%|█████████▎| 41/44 [01:37<00:07,  2.39s/it, loss=0.6131]Epoch 1/3:  95%|█████████▌| 42/44 [01:37<00:04,  2.00s/it, loss=0.6131]Epoch 1/3:  95%|█████████▌| 42/44 [01:40<00:04,  2.00s/it, loss=0.6489]Epoch 1/3:  98%|█████████▊| 43/44 [01:40<00:02,  2.10s/it, loss=0.6489]Epoch 1/3:  98%|█████████▊| 43/44 [01:41<00:02,  2.10s/it, loss=0.6308]Epoch 1/3: 100%|██████████| 44/44 [01:41<00:00,  1.99s/it, loss=0.6308]Epoch 1/3: 100%|██████████| 44/44 [01:41<00:00,  2.32s/it, loss=0.6308]
2025-12-23 15:34:53,804 - src.lora_trainer - INFO - 
============================================================
2025-12-23 15:34:53,804 - src.lora_trainer - INFO - Epoch 1/3 Summary
2025-12-23 15:34:53,804 - src.lora_trainer - INFO - ============================================================
2025-12-23 15:34:53,804 - src.lora_trainer - INFO -   Train Loss:    0.6608
2025-12-23 15:34:53,804 - src.lora_trainer - INFO -   (No validation data)
2025-12-23 15:34:53,804 - src.lora_trainer - INFO -   Learning Rate: 7.69e-05
2025-12-23 15:34:53,804 - src.lora_trainer - INFO - ============================================================

Epoch 2/3:   0%|          | 0/44 [00:00<?, ?it/s]Epoch 2/3:   0%|          | 0/44 [00:02<?, ?it/s, loss=0.6293]Epoch 2/3:   2%|▏         | 1/44 [00:02<01:46,  2.47s/it, loss=0.6293]Epoch 2/3:   2%|▏         | 1/44 [00:04<01:46,  2.47s/it, loss=0.6442]Epoch 2/3:   5%|▍         | 2/44 [00:04<01:41,  2.42s/it, loss=0.6442]Epoch 2/3:   5%|▍         | 2/44 [00:07<01:41,  2.42s/it, loss=0.6054]Epoch 2/3:   7%|▋         | 3/44 [00:07<01:37,  2.38s/it, loss=0.6054]Epoch 2/3:   7%|▋         | 3/44 [00:09<01:37,  2.38s/it, loss=0.6103]Epoch 2/3:   9%|▉         | 4/44 [00:09<01:34,  2.36s/it, loss=0.6103]Epoch 2/3:   9%|▉         | 4/44 [00:11<01:34,  2.36s/it, loss=0.6615]Epoch 2/3:  11%|█▏        | 5/44 [00:11<01:33,  2.39s/it, loss=0.6615]Epoch 2/3:  11%|█▏        | 5/44 [00:14<01:33,  2.39s/it, loss=0.6554]Epoch 2/3:  14%|█▎        | 6/44 [00:14<01:30,  2.37s/it, loss=0.6554]Epoch 2/3:  14%|█▎        | 6/44 [00:16<01:30,  2.37s/it, loss=0.6612]Epoch 2/3:  16%|█▌        | 7/44 [00:16<01:27,  2.38s/it, loss=0.6612]Epoch 2/3:  16%|█▌        | 7/44 [00:19<01:27,  2.38s/it, loss=0.6381]Epoch 2/3:  18%|█▊        | 8/44 [00:19<01:25,  2.37s/it, loss=0.6381]Epoch 2/3:  18%|█▊        | 8/44 [00:21<01:25,  2.37s/it, loss=0.6540]Epoch 2/3:  20%|██        | 9/44 [00:21<01:22,  2.36s/it, loss=0.6540]Epoch 2/3:  20%|██        | 9/44 [00:23<01:22,  2.36s/it, loss=0.6642]Epoch 2/3:  23%|██▎       | 10/44 [00:23<01:21,  2.39s/it, loss=0.6642]Epoch 2/3:  23%|██▎       | 10/44 [00:26<01:21,  2.39s/it, loss=0.6623]Epoch 2/3:  25%|██▌       | 11/44 [00:26<01:17,  2.36s/it, loss=0.6623]Epoch 2/3:  25%|██▌       | 11/44 [00:28<01:17,  2.36s/it, loss=0.6421]Epoch 2/3:  27%|██▋       | 12/44 [00:28<01:16,  2.40s/it, loss=0.6421]Epoch 2/3:  27%|██▋       | 12/44 [00:31<01:16,  2.40s/it, loss=0.6753]Epoch 2/3:  30%|██▉       | 13/44 [00:31<01:14,  2.41s/it, loss=0.6753]Epoch 2/3:  30%|██▉       | 13/44 [00:33<01:14,  2.41s/it, loss=0.6706]Epoch 2/3:  32%|███▏      | 14/44 [00:33<01:11,  2.39s/it, loss=0.6706]Epoch 2/3:  32%|███▏      | 14/44 [00:35<01:11,  2.39s/it, loss=0.6469]Epoch 2/3:  34%|███▍      | 15/44 [00:35<01:08,  2.37s/it, loss=0.6469]Epoch 2/3:  34%|███▍      | 15/44 [00:38<01:08,  2.37s/it, loss=0.6480]Epoch 2/3:  36%|███▋      | 16/44 [00:38<01:07,  2.41s/it, loss=0.6480]Epoch 2/3:  36%|███▋      | 16/44 [00:40<01:07,  2.41s/it, loss=0.6668]Epoch 2/3:  39%|███▊      | 17/44 [00:40<01:05,  2.42s/it, loss=0.6668]Epoch 2/3:  39%|███▊      | 17/44 [00:43<01:05,  2.42s/it, loss=0.6645]Epoch 2/3:  41%|████      | 18/44 [00:43<01:02,  2.41s/it, loss=0.6645]Epoch 2/3:  41%|████      | 18/44 [00:45<01:02,  2.41s/it, loss=0.6473]Epoch 2/3:  43%|████▎     | 19/44 [00:45<00:59,  2.38s/it, loss=0.6473]Epoch 2/3:  43%|████▎     | 19/44 [00:47<00:59,  2.38s/it, loss=0.6392]Epoch 2/3:  45%|████▌     | 20/44 [00:47<00:57,  2.41s/it, loss=0.6392]Epoch 2/3:  45%|████▌     | 20/44 [00:50<00:57,  2.41s/it, loss=0.6602]Epoch 2/3:  48%|████▊     | 21/44 [00:50<00:55,  2.43s/it, loss=0.6602]Epoch 2/3:  48%|████▊     | 21/44 [00:52<00:55,  2.43s/it, loss=0.6822]Epoch 2/3:  50%|█████     | 22/44 [00:52<00:53,  2.43s/it, loss=0.6822]Epoch 2/3:  50%|█████     | 22/44 [00:55<00:53,  2.43s/it, loss=0.6662]Epoch 2/3:  52%|█████▏    | 23/44 [00:55<00:50,  2.41s/it, loss=0.6662]Epoch 2/3:  52%|█████▏    | 23/44 [00:55<00:50,  2.41s/it, loss=0.5491]Epoch 2/3:  55%|█████▍    | 24/44 [00:55<00:37,  1.90s/it, loss=0.5491]Epoch 2/3:  55%|█████▍    | 24/44 [00:58<00:37,  1.90s/it, loss=0.6376]Epoch 2/3:  57%|█████▋    | 25/44 [00:58<00:38,  2.02s/it, loss=0.6376]Epoch 2/3:  57%|█████▋    | 25/44 [01:00<00:38,  2.02s/it, loss=0.6112]Epoch 2/3:  59%|█████▉    | 26/44 [01:00<00:38,  2.15s/it, loss=0.6112]Epoch 2/3:  59%|█████▉    | 26/44 [01:02<00:38,  2.15s/it, loss=0.6081]Epoch 2/3:  61%|██████▏   | 27/44 [01:02<00:37,  2.22s/it, loss=0.6081]Epoch 2/3:  61%|██████▏   | 27/44 [01:05<00:37,  2.22s/it, loss=0.6816]Epoch 2/3:  64%|██████▎   | 28/44 [01:05<00:36,  2.25s/it, loss=0.6816]Epoch 2/3:  64%|██████▎   | 28/44 [01:07<00:36,  2.25s/it, loss=0.6810]Epoch 2/3:  66%|██████▌   | 29/44 [01:07<00:33,  2.26s/it, loss=0.6810]Epoch 2/3:  66%|██████▌   | 29/44 [01:09<00:33,  2.26s/it, loss=0.6273]Epoch 2/3:  68%|██████▊   | 30/44 [01:09<00:31,  2.27s/it, loss=0.6273]Epoch 2/3:  68%|██████▊   | 30/44 [01:12<00:31,  2.27s/it, loss=0.6788]Epoch 2/3:  70%|███████   | 31/44 [01:12<00:29,  2.28s/it, loss=0.6788]Epoch 2/3:  70%|███████   | 31/44 [01:14<00:29,  2.28s/it, loss=0.6012]Epoch 2/3:  73%|███████▎  | 32/44 [01:14<00:28,  2.33s/it, loss=0.6012]Epoch 2/3:  73%|███████▎  | 32/44 [01:16<00:28,  2.33s/it, loss=0.6475]Epoch 2/3:  75%|███████▌  | 33/44 [01:16<00:25,  2.34s/it, loss=0.6475]Epoch 2/3:  75%|███████▌  | 33/44 [01:19<00:25,  2.34s/it, loss=0.6571]Epoch 2/3:  77%|███████▋  | 34/44 [01:19<00:23,  2.33s/it, loss=0.6571]Epoch 2/3:  77%|███████▋  | 34/44 [01:20<00:23,  2.33s/it, loss=0.6408]Epoch 2/3:  80%|███████▉  | 35/44 [01:20<00:18,  2.07s/it, loss=0.6408]Epoch 2/3:  80%|███████▉  | 35/44 [01:23<00:18,  2.07s/it, loss=0.6154]Epoch 2/3:  82%|████████▏ | 36/44 [01:23<00:17,  2.19s/it, loss=0.6154]Epoch 2/3:  82%|████████▏ | 36/44 [01:25<00:17,  2.19s/it, loss=0.6414]Epoch 2/3:  84%|████████▍ | 37/44 [01:25<00:15,  2.23s/it, loss=0.6414]Epoch 2/3:  84%|████████▍ | 37/44 [01:27<00:15,  2.23s/it, loss=0.6563]Epoch 2/3:  86%|████████▋ | 38/44 [01:27<00:13,  2.26s/it, loss=0.6563]Epoch 2/3:  86%|████████▋ | 38/44 [01:30<00:13,  2.26s/it, loss=0.6515]Epoch 2/3:  89%|████████▊ | 39/44 [01:30<00:11,  2.28s/it, loss=0.6515]Epoch 2/3:  89%|████████▊ | 39/44 [01:32<00:11,  2.28s/it, loss=0.6446]Epoch 2/3:  91%|█████████ | 40/44 [01:32<00:09,  2.31s/it, loss=0.6446]Epoch 2/3:  91%|█████████ | 40/44 [01:34<00:09,  2.31s/it, loss=0.6862]Epoch 2/3:  93%|█████████▎| 41/44 [01:34<00:06,  2.32s/it, loss=0.6862]Epoch 2/3:  93%|█████████▎| 41/44 [01:37<00:06,  2.32s/it, loss=0.6483]Epoch 2/3:  95%|█████████▌| 42/44 [01:37<00:04,  2.32s/it, loss=0.6483]Epoch 2/3:  95%|█████████▌| 42/44 [01:39<00:04,  2.32s/it, loss=0.6159]Epoch 2/3:  98%|█████████▊| 43/44 [01:39<00:02,  2.36s/it, loss=0.6159]Epoch 2/3:  98%|█████████▊| 43/44 [01:40<00:02,  2.36s/it, loss=0.5481]Epoch 2/3: 100%|██████████| 44/44 [01:40<00:00,  1.82s/it, loss=0.5481]Epoch 2/3: 100%|██████████| 44/44 [01:40<00:00,  2.28s/it, loss=0.5481]
2025-12-23 15:36:34,060 - src.lora_trainer - INFO - 
============================================================
2025-12-23 15:36:34,060 - src.lora_trainer - INFO - Epoch 2/3 Summary
2025-12-23 15:36:34,060 - src.lora_trainer - INFO - ============================================================
2025-12-23 15:36:34,060 - src.lora_trainer - INFO -   Train Loss:    0.6437
2025-12-23 15:36:34,060 - src.lora_trainer - INFO -   (No validation data)
2025-12-23 15:36:34,060 - src.lora_trainer - INFO -   Learning Rate: 1.54e-04
2025-12-23 15:36:34,060 - src.lora_trainer - INFO - ============================================================

Epoch 3/3:   0%|          | 0/44 [00:00<?, ?it/s]Epoch 3/3:   0%|          | 0/44 [00:02<?, ?it/s, loss=0.6476]Epoch 3/3:   2%|▏         | 1/44 [00:02<01:38,  2.29s/it, loss=0.6476]Epoch 3/3:   2%|▏         | 1/44 [00:04<01:38,  2.29s/it, loss=0.6520]Epoch 3/3:   5%|▍         | 2/44 [00:04<01:38,  2.34s/it, loss=0.6520]Epoch 3/3:   5%|▍         | 2/44 [00:07<01:38,  2.34s/it, loss=0.6220]Epoch 3/3:   7%|▋         | 3/44 [00:07<01:38,  2.39s/it, loss=0.6220]Epoch 3/3:   7%|▋         | 3/44 [00:09<01:38,  2.39s/it, loss=0.6356]Epoch 3/3:   9%|▉         | 4/44 [00:09<01:33,  2.35s/it, loss=0.6356]Epoch 3/3:   9%|▉         | 4/44 [00:11<01:33,  2.35s/it, loss=0.6597]Epoch 3/3:  11%|█▏        | 5/44 [00:11<01:30,  2.33s/it, loss=0.6597]Epoch 3/3:  11%|█▏        | 5/44 [00:14<01:30,  2.33s/it, loss=0.6171]Epoch 3/3:  14%|█▎        | 6/44 [00:14<01:30,  2.37s/it, loss=0.6171]Epoch 3/3:  14%|█▎        | 6/44 [00:16<01:30,  2.37s/it, loss=0.6577]Epoch 3/3:  16%|█▌        | 7/44 [00:16<01:27,  2.37s/it, loss=0.6577]Epoch 3/3:  16%|█▌        | 7/44 [00:18<01:27,  2.37s/it, loss=0.5866]Epoch 3/3:  18%|█▊        | 8/44 [00:18<01:26,  2.39s/it, loss=0.5866]Epoch 3/3:  18%|█▊        | 8/44 [00:21<01:26,  2.39s/it, loss=0.6216]Epoch 3/3:  20%|██        | 9/44 [00:21<01:24,  2.42s/it, loss=0.6216]Epoch 3/3:  20%|██        | 9/44 [00:23<01:24,  2.42s/it, loss=0.6410]Epoch 3/3:  23%|██▎       | 10/44 [00:23<01:21,  2.38s/it, loss=0.6410]Epoch 3/3:  23%|██▎       | 10/44 [00:26<01:21,  2.38s/it, loss=0.6463]Epoch 3/3:  25%|██▌       | 11/44 [00:26<01:19,  2.41s/it, loss=0.6463]Epoch 3/3:  25%|██▌       | 11/44 [00:28<01:19,  2.41s/it, loss=0.6538]Epoch 3/3:  27%|██▋       | 12/44 [00:28<01:16,  2.39s/it, loss=0.6538]Epoch 3/3:  27%|██▋       | 12/44 [00:30<01:16,  2.39s/it, loss=0.6513]Epoch 3/3:  30%|██▉       | 13/44 [00:30<01:14,  2.39s/it, loss=0.6513]Epoch 3/3:  30%|██▉       | 13/44 [00:33<01:14,  2.39s/it, loss=0.6713]Epoch 3/3:  32%|███▏      | 14/44 [00:33<01:10,  2.35s/it, loss=0.6713]Epoch 3/3:  32%|███▏      | 14/44 [00:35<01:10,  2.35s/it, loss=0.6047]Epoch 3/3:  34%|███▍      | 15/44 [00:35<01:08,  2.36s/it, loss=0.6047]Epoch 3/3:  34%|███▍      | 15/44 [00:38<01:08,  2.36s/it, loss=0.6258]Epoch 3/3:  36%|███▋      | 16/44 [00:38<01:06,  2.39s/it, loss=0.6258]Epoch 3/3:  36%|███▋      | 16/44 [00:40<01:06,  2.39s/it, loss=0.6462]Epoch 3/3:  39%|███▊      | 17/44 [00:40<01:04,  2.38s/it, loss=0.6462]Epoch 3/3:  39%|███▊      | 17/44 [00:42<01:04,  2.38s/it, loss=0.6498]Epoch 3/3:  41%|████      | 18/44 [00:42<01:01,  2.37s/it, loss=0.6498]Epoch 3/3:  41%|████      | 18/44 [00:45<01:01,  2.37s/it, loss=0.6325]Epoch 3/3:  43%|████▎     | 19/44 [00:45<01:00,  2.40s/it, loss=0.6325]Epoch 3/3:  43%|████▎     | 19/44 [00:47<01:00,  2.40s/it, loss=0.6405]Epoch 3/3:  45%|████▌     | 20/44 [00:47<00:53,  2.24s/it, loss=0.6405]Epoch 3/3:  45%|████▌     | 20/44 [00:48<00:53,  2.24s/it, loss=0.6352]Epoch 3/3:  48%|████▊     | 21/44 [00:48<00:46,  2.01s/it, loss=0.6352]Epoch 3/3:  48%|████▊     | 21/44 [00:50<00:46,  2.01s/it, loss=0.6660]Epoch 3/3:  50%|█████     | 22/44 [00:50<00:43,  1.96s/it, loss=0.6660]Epoch 3/3:  50%|█████     | 22/44 [00:52<00:43,  1.96s/it, loss=0.6612]Epoch 3/3:  52%|█████▏    | 23/44 [00:52<00:43,  2.05s/it, loss=0.6612]Epoch 3/3:  52%|█████▏    | 23/44 [00:55<00:43,  2.05s/it, loss=0.6535]Epoch 3/3:  55%|█████▍    | 24/44 [00:55<00:43,  2.15s/it, loss=0.6535]Epoch 3/3:  55%|█████▍    | 24/44 [00:57<00:43,  2.15s/it, loss=0.5993]Epoch 3/3:  57%|█████▋    | 25/44 [00:57<00:42,  2.22s/it, loss=0.5993]Epoch 3/3:  57%|█████▋    | 25/44 [00:59<00:42,  2.22s/it, loss=0.6348]Epoch 3/3:  59%|█████▉    | 26/44 [00:59<00:41,  2.30s/it, loss=0.6348]Epoch 3/3:  59%|█████▉    | 26/44 [01:02<00:41,  2.30s/it, loss=0.6433]Epoch 3/3:  61%|██████▏   | 27/44 [01:02<00:39,  2.30s/it, loss=0.6433]Epoch 3/3:  61%|██████▏   | 27/44 [01:04<00:39,  2.30s/it, loss=0.6562]Epoch 3/3:  64%|██████▎   | 28/44 [01:04<00:37,  2.32s/it, loss=0.6562]Epoch 3/3:  64%|██████▎   | 28/44 [01:07<00:37,  2.32s/it, loss=0.6529]Epoch 3/3:  66%|██████▌   | 29/44 [01:07<00:35,  2.37s/it, loss=0.6529]Epoch 3/3:  66%|██████▌   | 29/44 [01:09<00:35,  2.37s/it, loss=0.5868]Epoch 3/3:  68%|██████▊   | 30/44 [01:09<00:32,  2.36s/it, loss=0.5868]Epoch 3/3:  68%|██████▊   | 30/44 [01:11<00:32,  2.36s/it, loss=0.6609]Epoch 3/3:  70%|███████   | 31/44 [01:11<00:29,  2.31s/it, loss=0.6609]Epoch 3/3:  70%|███████   | 31/44 [01:13<00:29,  2.31s/it, loss=0.6649]Epoch 3/3:  73%|███████▎  | 32/44 [01:13<00:27,  2.32s/it, loss=0.6649]Epoch 3/3:  73%|███████▎  | 32/44 [01:16<00:27,  2.32s/it, loss=0.6109]Epoch 3/3:  75%|███████▌  | 33/44 [01:16<00:25,  2.32s/it, loss=0.6109]Epoch 3/3:  75%|███████▌  | 33/44 [01:18<00:25,  2.32s/it, loss=0.6286]Epoch 3/3:  77%|███████▋  | 34/44 [01:18<00:23,  2.31s/it, loss=0.6286]Epoch 3/3:  77%|███████▋  | 34/44 [01:20<00:23,  2.31s/it, loss=0.6128]Epoch 3/3:  80%|███████▉  | 35/44 [01:20<00:21,  2.34s/it, loss=0.6128]Epoch 3/3:  80%|███████▉  | 35/44 [01:23<00:21,  2.34s/it, loss=0.6039]Epoch 3/3:  82%|████████▏ | 36/44 [01:23<00:18,  2.34s/it, loss=0.6039]Epoch 3/3:  82%|████████▏ | 36/44 [01:25<00:18,  2.34s/it, loss=0.6197]Epoch 3/3:  84%|████████▍ | 37/44 [01:25<00:16,  2.38s/it, loss=0.6197]Epoch 3/3:  84%|████████▍ | 37/44 [01:28<00:16,  2.38s/it, loss=0.6654]Epoch 3/3:  86%|████████▋ | 38/44 [01:28<00:14,  2.35s/it, loss=0.6654]Epoch 3/3:  86%|████████▋ | 38/44 [01:30<00:14,  2.35s/it, loss=0.6458]Epoch 3/3:  89%|████████▊ | 39/44 [01:30<00:11,  2.33s/it, loss=0.6458]Epoch 3/3:  89%|████████▊ | 39/44 [01:32<00:11,  2.33s/it, loss=0.6186]Epoch 3/3:  91%|█████████ | 40/44 [01:32<00:09,  2.33s/it, loss=0.6186]Epoch 3/3:  91%|█████████ | 40/44 [01:35<00:09,  2.33s/it, loss=0.6130]Epoch 3/3:  93%|█████████▎| 41/44 [01:35<00:07,  2.36s/it, loss=0.6130]Epoch 3/3:  93%|█████████▎| 41/44 [01:37<00:07,  2.36s/it, loss=0.6290]Epoch 3/3:  95%|█████████▌| 42/44 [01:37<00:04,  2.39s/it, loss=0.6290]Epoch 3/3:  95%|█████████▌| 42/44 [01:39<00:04,  2.39s/it, loss=0.6351]Epoch 3/3:  98%|█████████▊| 43/44 [01:39<00:02,  2.39s/it, loss=0.6351]Epoch 3/3:  98%|█████████▊| 43/44 [01:41<00:02,  2.39s/it, loss=0.6402]Epoch 3/3: 100%|██████████| 44/44 [01:41<00:00,  2.20s/it, loss=0.6402]Epoch 3/3: 100%|██████████| 44/44 [01:41<00:00,  2.31s/it, loss=0.6402]
2025-12-23 15:38:15,770 - src.lora_trainer - INFO - 
============================================================
2025-12-23 15:38:15,770 - src.lora_trainer - INFO - Epoch 3/3 Summary
2025-12-23 15:38:15,770 - src.lora_trainer - INFO - ============================================================
2025-12-23 15:38:15,770 - src.lora_trainer - INFO -   Train Loss:    0.6364
2025-12-23 15:38:15,770 - src.lora_trainer - INFO -   (No validation data)
2025-12-23 15:38:15,770 - src.lora_trainer - INFO -   Learning Rate: 2.00e-04
2025-12-23 15:38:15,770 - src.lora_trainer - INFO - ============================================================

2025-12-23 15:38:15,770 - src.lora_trainer - INFO - Training completed. Average loss: 0.6470
2025-12-23 15:38:16,544 - src.lora_trainer - INFO - ✓ Training curves saved to: logs/training_curves/benign_20251223_153816.png
2025-12-23 15:38:16,544 - src.lora_trainer - INFO - ✓ Training data saved to: logs/training_curves/benign_20251223_153816.csv
2025-12-23 15:38:16,607 - src.lora_trainer - INFO - ✓ Extracted 256 LoRA parameters
2025-12-23 15:38:16,607 - __main__ - INFO - 
Saving A7 adapter...
2025-12-23 15:38:16,651 - src.adapter_utils - INFO - ✓ Adapter saved to: saved_adapters/mistral-7b-v0.2/utility_model/utility_model_A7.pt
2025-12-23 15:38:16,651 - src.adapter_utils - INFO -   Metadata: {'type': 'utility_model_A7', 'task': 'security', 'model': 'mistral-7b-v0.2', 'note': 'Security instruction-response model'}
2025-12-23 15:38:16,651 - __main__ - INFO - 
✓ A7 adapter saved to: saved_adapters/mistral-7b-v0.2/utility_model/utility_model_A7.pt
2025-12-23 15:38:16,651 - __main__ - INFO - 
================================================================================
2025-12-23 15:38:16,651 - __main__ - INFO - A7 (Security) MODEL CREATION COMPLETED
2025-12-23 15:38:16,651 - __main__ - INFO - ================================================================================
2025-12-23 15:38:16,651 - __main__ - INFO - 
Note: Evaluation will be performed separately using evaluate_all_models.py
