# A5+A7 k-alphaパラメータ最適化分析

## 評価結果一覧

| k | α | Jailbreak RtA | BeaverTails | MMLU | RepliQA |
|---|---|---------------|-------------|------|---------|
| 3 | 1.0 | 75.8% | 2.0% | 52.3% | 0.405 |
| 5 | 0.5 | 57.4% | 11.8% | 55.9% | N/A |
| 10 | 0.8 | 70.6% | 6.0% | 54.0% | 0.324 |
| 20 | 1.0 | **77.6%** | 2.0% | 52.9% | **0.405** |

## ランキング分析

### 🏆 Jailbreak耐性 TOP 3
1. **k=20, α=1.0**: 77.6% ⭐
2. k=3, α=1.0: 75.8%
3. k=10, α=0.8: 70.6%

### 🏆 MMLU正解率 TOP 3
1. **k=5, α=0.5**: 55.9% ⭐
2. k=10, α=0.8: 54.0%
3. k=20, α=1.0: 52.9%

### 🏆 RepliQA ROUGE-L TOP 3
1. **k=3, α=1.0**: 0.405 ⭐ (同率1位)
2. **k=20, α=1.0**: 0.405 ⭐ (同率1位)
3. k=10, α=0.8: 0.324

### 🏆 バランス総合スコア TOP 3
1. **k=20, α=1.0**: 0.603 ⭐
2. k=3, α=1.0: 0.593
3. k=10, α=0.8: 0.563

*バランススコア = Jailbreak×0.4 + MMLU×0.4 + RepliQA×0.2*

## 推奨パラメータ

### 🥇 総合最優秀: k=20, α=1.0

**理由**:
- Jailbreak耐性が最高（77.6%）
- RepliQA性能も最高（0.405）
- バランス総合スコアが最高（0.603）
- MMLU正解率も十分高い（52.9%）

**適用シーン**: 
- Safety性能を最優先しつつ、Utility性能も維持したい場合
- 本番環境での推奨設定

### 🥈 Utility重視: k=5, α=0.5

**理由**:
- MMLU正解率が最高（55.9%）
- BeaverTails拒否率が適度（11.8%、過剰拒否を避ける）

**適用シーン**:
- タスク性能を最優先する場合
- 内部テストや研究用途

**注意点**:
- Jailbreak耐性が低い（57.4%）
- RepliQAデータが欠損

### 🥉 軽量バランス型: k=3, α=1.0

**理由**:
- k値が最小（計算コスト最小）
- Jailbreak耐性が高い（75.8%）
- RepliQA性能が最高（0.405）

**適用シーン**:
- 計算リソースが限られている場合
- 高速な推論が必要な場合

## パラメータの影響分析

### α値の影響

| α値 | Safety傾向 | Utility傾向 |
|-----|-----------|------------|
| 1.0 | 最高 (77.6%) | 中程度 (52.9%) |
| 0.8 | 高 (70.6%) | 高 (54.0%) |
| 0.5 | 低 (57.4%) | 最高 (55.9%) |

**結論**: α値を下げるとUtility性能が向上するが、Safety性能が低下する明確なトレードオフが存在。

### k値の影響

| k値 | Jailbreak | MMLU | 計算コスト |
|-----|-----------|------|-----------|
| 3 | 75.8% | 52.3% | 最小 |
| 5 | 57.4% | 55.9% | 小 |
| 10 | 70.6% | 54.0% | 中 |
| 20 | 77.6% | 52.9% | 大 |

**結論**: k値を増やすとSafety性能が向上するが、計算コストも増加。k=20が性能と効率のバランスが良い。

## 実装推奨

### 本番環境
```python
k = 20
alpha = 1.0
```

### 開発/テスト環境
```python
k = 10
alpha = 0.8
```

### リソース制約環境
```python
k = 3
alpha = 1.0
```

## 追加調査が必要な項目

1. **k=5, α=0.5のRepliQAデータ**: 評価が欠損しているため、再評価が必要
2. **Tier 3の詳細探索**: k=15-25, α=0.9-1.0の範囲でさらに最適化の余地あり
3. **BeaverTails拒否率の解釈**: 2.0%は低すぎる可能性があり、過小拒否のリスクを検証する必要あり
