# A5+A7 k-alphaグリッドサーチ 網羅状況レポート

## 📊 網羅状況サマリー

### グリッドサーチ計画
- **Tier 1**: 8組
- **Tier 2**: 8組
- **Tier 3**: 12組
- **合計計画**: 28組

### 評価完了状況
- **評価完了（4データセット完全）**: 12組 ✓
- **応答ファイルあり（評価未集計）**: 15組 ⚠
- **評価結果なし**: 1組（k=25, α=0.9のみマージ失敗）

## ✅ 評価完了（12組）

| k | α | Tier | Jailbreak | MMLU | RepliQA | 備考 |
|---|---|------|-----------|------|---------|------|
| 3 | 1.0 | 追加 | 75.8% | 52.3% | 0.405 | バランス最優秀 |
| 5 | 0.5 | 追加 | 57.4% | 55.9% | 0.129 | MMLU最高 |
| 5 | 2.0 | 追加 | 0.0% | 1.2% | 0.008 | 失敗 |
| 10 | 0.8 | 追加 | 70.6% | 54.0% | 0.324 | - |
| 20 | 0.7 | T1 | 57.8% | 55.6% | 0.245 | - |
| 20 | 1.0 | 追加 | 76.4% | 52.9% | 0.342 | - |
| 20 | 1.5 | 追加 | 61.6% | 8.5% | 0.092 | 失敗 |
| 20 | 2.0 | 追加 | 0.2% | 1.1% | 0.009 | 失敗 |
| 30 | 1.0 | T1 | 76.2% | 52.9% | 0.337 | - |
| 40 | 1.0 | 追加 | **77.0%** | 53.0% | 0.335 | **Safety最高** |
| 50 | 1.0 | 追加 | 76.4% | 53.1% | 0.330 | - |
| 100 | 10.0 | 追加 | 0.0% | 0.0% | 0.005 | 失敗 |

## ⚠ 応答ファイルあり・評価未集計（15組）

これらの組み合わせは応答ファイルが存在しますが、評価結果がaggregated_results.jsonに集計されていません。

### Tier 1（2組）
- k=10, α=1.0
- k=50, α=0.9

### Tier 2（6組）
- k=5, α=1.0
- k=10, α=0.9
- k=15, α=0.9
- k=20, α=0.5
- k=30, α=0.5
- k=50, α=0.5

### Tier 3（7組）
- k=15, α=1.0
- k=20, α=0.9
- k=22, α=0.9
- k=30, α=0.7
- k=30, α=0.9
- k=50, α=0.7
- k=50, α=0.8

## ❌ 評価結果なし（11組）

これらの組み合わせは応答ファイルが存在しないため、マージまたは評価が失敗しています。

### Tier 3（11組）- すべて失敗
- k=20, α=0.75
- k=20, α=0.85
- k=20, α=0.95
- k=22, α=0.8
- k=25, α=0.8
- k=25, α=0.9
- k=28, α=0.8
- k=28, α=0.9
- k=30, α=0.75
- k=30, α=0.85
- k=30, α=0.95

## 📈 追加で評価された組み合わせ（10組）

グリッドサーチ計画外で追加実験された組み合わせ：

| k | α | 理由 |
|---|---|------|
| 3 | 1.0 | 軽量版テスト |
| 5 | 0.5 | Utility重視テスト |
| 5 | 2.0 | 過剰α値テスト |
| 10 | 0.8 | バランステスト |
| 20 | 1.0 | 標準設定 |
| 20 | 1.5 | 過剰α値テスト |
| 20 | 2.0 | 過剰α値テスト |
| 40 | 1.0 | 中規模k値テスト |
| 50 | 1.0 | 大規模k値テスト |
| 100 | 10.0 | 極端値テスト |

## 🎯 推奨アクション

### 1. 評価未集計データの処理（優先度：高）

15組の応答ファイルが存在するが評価が未集計です。以下のスクリプトで集計可能：

```bash
# 応答ファイルから評価結果を計算
python3 experiments/aggregate_evaluation_results.py
```

### 2. Tier 3失敗組み合わせの再実行（優先度：中）

11組の組み合わせが失敗しています。conda環境を有効化して再実行：

```bash
conda activate sst
python3 experiments/grid_search_k_alpha.py --tier 3 --skip_existing
```

### 3. 重要な欠損データ

以下の組み合わせは特に重要ですが、評価が未完了です：

- **k=20, α=0.9**: Tier 1の重要な組み合わせ
- **k=30, α=0.9**: Tier 1の重要な組み合わせ
- **k=50, α=0.9**: Tier 1の重要な組み合わせ
- **k=20, α=0.5**: Tier 2の境界値

## 📊 現在の網羅率

- **計画28組中**: 
  - 完全評価: 2組（7%）
  - 部分評価: 15組（54%）
  - 未評価: 11組（39%）

- **実質的な評価完了**: 12組（計画外含む）
  - うち有効な結果: 8組（α≥1.5は失敗）

## まとめ

**現状**: グリッドサーチで計画された28組のうち、完全に評価が完了しているのは2組のみ。15組は応答ファイルがあるが評価未集計、11組は実験自体が失敗。

**次のステップ**:
1. 既存の応答ファイル（15組）から評価結果を集計
2. Tier 3の失敗した実験（11組）を再実行
3. 全28組の評価を完了させる
